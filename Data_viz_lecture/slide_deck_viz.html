<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>An introduction to data visualisation</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr. Jonathan Leslie   Head of Data Science at Pivigo      jonleslie     @jlesliedata    jonathan.leslie@pivigo.com" />
    <script src="https://use.fontawesome.com/5235085b15.js"></script>
    <link rel="stylesheet" href="example.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# An introduction to data visualisation
### Dr. Jonathan Leslie <br> Head of Data Science at <a href="https://www.pivigo.com/">Pivigo</a> <br><br> <a href="https://github.com/jonleslie"><i class="fa fa-github fa-fw"></i>  jonleslie</a><br> <a href="https://twitter.com/jlesliedata"> <i class="fa fa-twitter fa-fw"></i>  <span class="citation">@jlesliedata</span></a><br> <a href="mailto:jonathan.leslie@pivigo.com"><i class="fa fa-paper-plane fa-fw"></i>  jonathan.leslie@pivigo.com</a><br>
### <br><br><br>

---


class: inverse
name: toc






# Table of Contents

- [Principles of data visualisation](#viz_principles)
- [Building a graphic](#building_a_graphic)
- [Data visualisation in R](#viz)
- [Other resources](#resources)

---

layout: true
class: inverse

.footer[[Return to Table of Contents](#toc)]

---

layout: true
class: inverse

---

# Acknowledgements

Dr. Chester Ismay &lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;a href="http://github.com/ismayc"&gt;&lt;i class="fa fa-github fa-fw"&gt;&lt;/i&gt;&amp;nbsp; ismayc&lt;/a&gt;&lt;br&gt; &lt;a href="http://twitter.com/old_man_chester"&gt; &lt;i class="fa fa-twitter fa-fw"&gt;&lt;/i&gt;&amp;nbsp; @old_man_chester&lt;/a&gt;&lt;br&gt;&lt;br&gt;
  
.footer[Slides available at http://bit.ly/ness-infer &amp;emsp; &amp;emsp; &amp;emsp; ]

---

# Acknowledgements

.pull-left[Claus O. Wilke &lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;a href="https://github.com/clauswilke"&gt;&lt;i class="fa fa-github fa-fw"&gt;&lt;/i&gt;&amp;nbsp; clauswilke&lt;/a&gt;&lt;br&gt; &lt;a href="https://twitter.com/ClausWilke"&gt; &lt;i class="fa fa-twitter fa-fw"&gt;&lt;/i&gt;&amp;nbsp; @ClausWilke&lt;/a&gt;&lt;br&gt;&lt;br&gt;]
.pull-right[&lt;img src="img/Fund_of_Data_Vis-cover.png" /&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;]

.footer[https://serialmentor.com/dataviz/index.html &amp;emsp; &amp;emsp; &amp;emsp; ]

---

layout: true
class: inverse

.footer[[Return to Table of Contents](#toc)]

---

name: viz_principles

# Principles of Visualisation
- Why do we use visualisations
- Some best practices

---

# Why do we use visualisations?

---

## To show a finding

&lt;img src="slide_deck_viz_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;


---

## To tell a story

&lt;img src="img/Minard's_Map_(vectorized).png" syle="width:300px; center" /&gt;

.small.right[Charles Joseph Minard (1869)]


---

## To make something beautiful

.center[&lt;img src="img/Switzerland.png" style="height:490px" /&gt;]

---

# Why do we use visualisations?

.center.large[&lt;br&gt;&lt;br&gt;&lt;span style="color:#FF0000"&gt;TO ACCURATELY EXCHANGE INFORMATION&lt;/span&gt;]

---

layout: true
class: inverse

---

# "The good, the bad and the ugly"

.center[&lt;img src="img/ugly-bad-wrong-examples-1.png" width="80%"/&gt;&lt;br&gt;]

.small.right[(https://serialmentor.com/dataviz/)]

---

layout: true
class: inverse

.footer[[Return to Table of Contents](#toc)]

---

# Another example

.center[&lt;img src="img/bad_fig.png_large" /&gt;]

---

# Some best practices
- Accuracy
- Reproducibility
- Autogeneration
  - Manual editing --&gt; irreproducibility
  - Easy to make changes
  - Future you may not know what pressent you did
- Avoid interactive plot programmes (Excel counts)

---

# Consider your audience
- Publication
- Conference talk
- Exploratory data analysis
- Progress report to your boss

---

name: building_a_graphic

# Building a graphic

- &lt;span style="color:#FF0000"&gt;__aes__&lt;/span&gt;thetic mapping
- &lt;span style="color:#FF0000"&gt;__geom__&lt;/span&gt;etric objects

[//]: # "https://stackoverflow.com/questions/29067541/how-to-change-the-font-color"

---

# Aesthetic mapping
- Mapping of data values to quantifiable features on the graphic
- Can include:
  - position
  - colour
  - shape
  - size
  
---

![](slide_deck_viz_files/figure-html/unnamed-chunk-4-1.png)&lt;!-- --&gt;

![](slide_deck_viz_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;



---

# Two different mappings of the same data

![](slide_deck_viz_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;

---

name: plot_types

# What plot should I use?

To answer this, you must know what data type you're working with:
- Continuous
- Categorical
- Ordinal
- Other

---

layout: false
class: center, middle
name: viz

# Data Visualization

&lt;center&gt;
&lt;a href="https://ggplot2.tidyverse.org"&gt;
&lt;img src="img/ggplot2_hex.png" style = "width: 400px;"/&gt;
&lt;/a&gt;
&lt;/center&gt;
---

layout: true
class: inverse

.footer[[Return to Table of Contents](#toc)]

---
&lt;img src="slide_deck_viz_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

- What are the variables here?
- What is the observational unit?
- How are the variables mapped to aesthetics?

---

class: center, middle

## Grammar of Graphics

Wilkinson (2005) laid out the proposed &lt;br&gt; "Grammar of Graphics"

&lt;br&gt;

&lt;a href="http://www.powells.com/book/the-grammar-of-graphics-9780387245447"&gt;&lt;img src="figure/graphics.jpg" style="width: 200px;"&gt;&lt;/a&gt;

---

class: center, middle

## Grammar of Graphics in R

Wickham implemented the grammar in R &lt;br&gt; in the `ggplot2` package

&lt;br&gt;

&lt;a href="http://www.powells.com/book/ggplot2-elegant-graphics-for-data-analysis-9783319242750/68-428"&gt;&lt;img src="figure/ggplot2.jpg" style="width: 200px;"&gt;&lt;/a&gt;

---

class: center, middle

## Edward Tufte pioneered the field of data visualisation

&lt;img src="img/Tufte_cover.jpg" style="width: 300; center" /&gt;

---

class: center, middle

&lt;img src="img/Minard's_Map_(vectorized).png" syle="width:300px; center" /&gt;

.small[Charles Joseph Minard (1869)]

---

class: center

## Another recommendation:

FUNDAMENTALS OF DATA VISUALISATION
Claus O. Wilke

https://serialmentor.com/dataviz/

---

class: center, middle

## What is a statistical graphic?

--

## A `mapping` of &lt;br&gt; `data` variables

--

## to &lt;br&gt; `aes()`thetic attributes

--

## of &lt;br&gt; `geom_`etric objects.

---

class: inverse, center, middle

# Back to Basics

---

## Old school

- Sketch the graphics below on paper, where the `x`-axis is variable `A` and the `y`-axis is variable `B`


```
# A tibble: 4 x 4
      A     B     C D    
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
1  1980     1     3 cold 
2  1990     2     2 cold 
3  2000     3     1 hot  
4  2010     4     2 hot  
```

&lt;!-- Copy to chalkboard/whiteboard --&gt;

1. &lt;small&gt;A scatter plot&lt;/small&gt;
1. &lt;small&gt;A scatter plot where the `color` of the points corresponds to `D`&lt;/small&gt;
1. &lt;small&gt;A scatter plot where the `size` of the points corresponds to `C`&lt;/small&gt;

---

layout: true
class: inverse

.footer[[Return to Table of Contents](#toc)]

---

## Reproducing the plots in `ggplot2`

### 1. A scatterplot


```r
library(ggplot2)
ggplot(data = simple_ex, mapping = aes(x = A, y = B)) + 
  geom_point()
```
--

![](slide_deck_viz_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;


---


## Reproducing the plots in `ggplot2`

### 2. A scatter plot where the `color` of the points corresponds to `D`


```r
library(ggplot2)
ggplot(data = simple_ex, mapping = aes(x = A, y = B)) + 
  geom_point(mapping = aes(color = D))
```
--

![](slide_deck_viz_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;


---

## Reproducing the plots in `ggplot2`

### 3. A scatter plot where the `size` of the points corresponds to `C`


```r
library(ggplot2)
ggplot(data = simple_ex, mapping = aes(x = A, y = B, size = C)) + 
  geom_point()
```
--

![](slide_deck_viz_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;

---

# Another example

Do cars with bigger engines have lower fuel efficiency?


```r
mpg
```

```
# A tibble: 234 x 11
   manufacturer model displ  year   cyl trans drv     cty   hwy fl   
   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
 1 audi         a4      1.8  1999     4 auto… f        18    29 p    
 2 audi         a4      1.8  1999     4 manu… f        21    29 p    
 3 audi         a4      2    2008     4 manu… f        20    31 p    
 4 audi         a4      2    2008     4 auto… f        21    30 p    
 5 audi         a4      2.8  1999     6 auto… f        16    26 p    
 6 audi         a4      2.8  1999     6 manu… f        18    26 p    
 7 audi         a4      3.1  2008     6 auto… f        18    27 p    
 8 audi         a4 q…   1.8  1999     4 manu… 4        18    26 p    
 9 audi         a4 q…   1.8  1999     4 auto… 4        16    25 p    
10 audi         a4 q…   2    2008     4 manu… 4        20    28 p    
# … with 224 more rows, and 1 more variable: class &lt;chr&gt;
```

---


```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;

---


```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
```

```
ggplot(data = &lt;DATA&gt;) + 
  &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;))
```

---

## Exercises
1. Run `ggplot(data = mpg)`. What do you see?

2. How many rows are in mpg? How many columns?

3. What does the `drv` variable describe? Read the help for `?mpg` to find out.

4. Make a scatterplot of hwy vs cyl.

1. What happens if you make a scatterplot of class vs drv? Why is the plot not useful?

---

# Aesthetic mapping

- An aesthetic is a visual property of the objects in your plot.

- Aesthetics include things like the size, the shape, or the color of your points.

---

## Mapping to colour


```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = class))
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-18-1.png)&lt;!-- --&gt;

---

## Mapping to shape


```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-19-1.png)&lt;!-- --&gt;

---

## Mapping to size


```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, size = class))
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-20-1.png)&lt;!-- --&gt;

---

# Facets


```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2)
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-21-1.png)&lt;!-- --&gt;

---

# Geometric objects

A geom is the geometrical object that a plot uses to represent data. 

---

## Same data, different `geom`s

![](slide_deck_viz_files/figure-html/unnamed-chunk-22-1.png)&lt;!-- --&gt;![](slide_deck_viz_files/figure-html/unnamed-chunk-22-2.png)&lt;!-- --&gt;


Exercise: try to create each of these plots

(hint: use `geom_smooth` for plot on the right)

---

## Can you create this one?

&lt;img src="slide_deck_viz_files/figure-html/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /&gt;

--


```r
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
```

---

## Introducing global mapping


```r
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
```

--


```r
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point() +
  geom_smooth()
```

--


```r
ggplot(mpg, aes(displ,hwy)) +
  geom_point() +
  geom_smooth()
```

---

## Local mappings overwrite global mappings for that _that layer only_


```r
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point() +
  geom_point(data = filter(mpg, class == "2seater"), colour = "red") 
```

&lt;img src="slide_deck_viz_files/figure-html/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /&gt;

---

# [The Five-Named Graphs](http://moderndive.com/3-viz.html#FiveNG)

## The 5NG of data viz

- Scatterplot: `geom_point()`
- Line graph: `geom_line()`
- Histogram: `geom_histogram()`
- Boxplot: `geom_boxplot()`
- Bar graph: `geom_bar()`


---

class: center, middle

## More examples

---

## Histogram


```r
library(nycflights13)
ggplot(data = weather, mapping = aes(x = humid)) +
  geom_histogram(bins = 20, color = "black", fill = "darkorange")
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-29-1.png)&lt;!-- --&gt;

---

## Boxplot (broken)


```r
library(nycflights13)
ggplot(data = weather, mapping = aes(x = month, y = humid)) +
  geom_boxplot()
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-30-1.png)&lt;!-- --&gt;

---


## Boxplot (fixed)


```r
library(nycflights13)
ggplot(data = weather, mapping = aes(x = factor(month), y = humid)) +
  geom_boxplot()
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-31-1.png)&lt;!-- --&gt;

---

## Bar graph


```r
library(fivethirtyeight)
ggplot(data = bechdel, mapping = aes(x = clean_test)) +
  geom_bar()
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-32-1.png)&lt;!-- --&gt;

---

## How about over time?

- One more variable to create with `dplyr`


```r
library(dplyr)
year_bins &lt;- c("'70-'74", "'75-'79", "'80-'84", "'85-'89",
               "'90-'94", "'95-'99", "'00-'04", "'05-'09",
               "'10-'13")
bechdel &lt;- bechdel %&gt;%
  mutate(five_year = cut(year, 
                         breaks = seq(1969, 2014, 5), 
                         labels = year_bins))
```

---

## How about over time? (Stacked)


```r
library(fivethirtyeight)
library(ggplot2)
ggplot(data = bechdel,
       mapping = aes(x = five_year, fill = clean_test)) +
  geom_bar() +
  scale_fill_brewer(type = "qual") # set colors
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-34-1.png)&lt;!-- --&gt;

---

## How about over time? (Side-by-side)


```r
library(fivethirtyeight)
library(ggplot2)
ggplot(data = bechdel,
       mapping = aes(x = five_year, fill = clean_test)) +
  geom_bar(position = "dodge") +
  scale_fill_brewer(type = "qual")
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-35-1.png)&lt;!-- --&gt;

---

## How about over time? (Stacked proportional)


```r
library(fivethirtyeight)
library(ggplot2)
ggplot(data = bechdel,
       mapping = aes(x = five_year, fill = clean_test)) +
  geom_bar(position = "fill", color = "black") +
  scale_fill_brewer(type = "qual")
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-36-1.png)&lt;!-- --&gt;

---

## Practice

Produce appropriate 5NG with R package &amp; data set in [ ], e.g., [`nycflights13::weather`] 

&lt;!--
Try to look through the help documentation/Google to improve your plots
--&gt;

1. How does `age` predict `recline_rude`? &lt;br&gt; [`fivethirtyeight::flying`]

2. Distribution of log base 10 scale of `budget_2013` &lt;br&gt; [`fivethirtyeight::bechdel`]

3. How does `budget` predict `rating`? &lt;br&gt; [`ggplot2movies::movies`]

---

### HINTS

![](slide_deck_viz_files/figure-html/unnamed-chunk-37-1.png)&lt;!-- --&gt;

---

class: center, middle

### Determining the appropriate plot

&lt;a href="https://coggle.it/diagram/V_G2gzukTDoQ-aZt"&gt;&lt;img src="figure/viz_mindmap.png" style="width: 385px;"/&gt;&lt;/a&gt;

---

## Some good resources for data visualisation

- [FUNDAMENTALS OF DATA VISUALISATION](https://serialmentor.com/dataviz/)
Claus O. Wilke
    + https://serialmentor.com/dataviz/
- [awesome-python](https://github.com/vinta/awesome-python#data-visualization)
    + https://github.com/vinta/awesome-python#data-visualization
- [Flowing data](http://flowingdata.com/)
    + http://flowingdata.com/
- [Tidy Tuesday](https://github.com/rfordatascience/tidytuesday)
    + https://github.com/rfordatascience/tidytuesday
    
---

# Review

- Write the code to produce this plot for 2007 data

![](slide_deck_viz_files/figure-html/unnamed-chunk-38-1.png)&lt;!-- --&gt;

---


```r
library(gapminder)
library(tidyverse)
gapminder_2007 &lt;- gapminder %&gt;% filter(year == 2007)
ggplot(data = gapminder_2007, 
       mapping = aes(x = gdpPercap, y = lifeExp, 
                     size = pop, color = continent)) +
  geom_point()
```

![](slide_deck_viz_files/figure-html/unnamed-chunk-39-1.png)&lt;!-- --&gt;

---

layout: true
class: inversekj

.footer[[Return to Table of Contents](#toc)]

---

layout: false
class: inverse, center, middle

# Thank you!

---

layout: false
class: inverse, middle

.center.large[Thanks for attending!]
&lt;br&gt;
Contact me: 
- jonathan.leslie@pivigo.com
- https://twitter.com/jlesliedata
&lt;br&gt;&lt;br&gt;

Special thanks to Chester Ismay 
- https://twitter.com/old_man_chester
- Slides' source code at &lt;https://github.com/ismayc/talks/&gt;
&lt;br&gt;&lt;br&gt;
- Slides created via the R package [xaringan](https://github.com/yihui/xaringan) by Yihui Xie
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "tomorrow-night-bright",
"highlightLines": true,
"highlightLanguage": "r",
"slideNumberFormat": "%current%/%total%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
